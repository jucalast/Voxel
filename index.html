<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vertex - Editor Voxel 3D</title>
  <link rel="icon" type="image/png" sizes="16x16" href="logo.png">
  <link rel="icon" type="image/png" sizes="32x32" href="logo.png">
  <link rel="icon" type="image/png" sizes="48x48" href="logo.png">
  <link rel="apple-touch-icon" sizes="180x180" href="logo.png">
  <meta name="msapplication-TileImage" content="logo.png">
  <!-- Favicon SVG para melhor qualidade -->
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><defs><linearGradient id='a' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' stop-color='%23666'/><stop offset='50%' stop-color='%23333'/><stop offset='100%' stop-color='%23111'/></linearGradient></defs><rect width='32' height='32' fill='%230a0a0a'/><g transform='translate(6,6)'><path d='M10 0 L20 5.77 L20 17.32 L10 23.09 L0 17.32 L0 5.77 Z' fill='url(%23a)' stroke='%23444' stroke-width='0.5'/><path d='M10 0 L20 5.77 L10 11.55 Z' fill='%23888'/><path d='M0 5.77 L10 11.55 L10 23.09 L0 17.32 Z' fill='%23222'/><path d='M10 11.55 L20 5.77 L20 17.32 L10 23.09 Z' fill='%23444'/></g></svg>">

  <link rel="stylesheet" href="styles.css">





</head>
<body>
  <div id="main-container">
    <!-- Barra Flutuante no Topo -->
    <div id="top-bar" class="floating-bar" style="display: flex;">
        <button id="enter-walk-mode-btn" class="icon-btn" data-tooltip="Modo Primeira Pessoa">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </button>
        
        <!-- Room Mode Controls (hidden by default) -->
        <div id="room-controls" style="display: none;">
          <div class="toolbar-separator"></div>
          
          <button id="room-upload-btn" class="icon-btn" data-tooltip="Upload/Controles">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17,8 12,3 7,8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
          </button>
          
          <button id="room-dimensions-btn" class="icon-btn" data-tooltip="Dimensões">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26"/>
              <path d="M16 16v1.5a2.5 2.5 0 0 1-5 0V16"/>
              <path d="M8 8v8"/>
              <path d="M16 8v8"/>
            </svg>
          </button>
          
          <button id="room-textures-btn" class="icon-btn" data-tooltip="Texturas Ambiente">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
              <polyline points="9,22 9,12 15,12 15,22"/>
            </svg>
          </button>
          
          <button id="room-doors-btn" class="icon-btn" data-tooltip="Portas">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
              <circle cx="10" cy="12" r="1"/>
            </svg>
          </button>
          
          <button id="room-windows-btn" class="icon-btn" data-tooltip="Janelas">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <path d="M9 3v18"/>
              <path d="M15 3v18"/>
              <path d="M3 9h18"/>
              <path d="M3 15h18"/>
            </svg>
          </button>
          
          <button id="room-voxel-textures-btn" class="icon-btn" data-tooltip="Texturas Voxels">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
              <circle cx="9" cy="9" r="2"/>
              <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
            </svg>
          </button>
        </div>
      </div>
    
    <div id="left-panel">
      <div id="color-section">
        <div id="color-title">Color Palette</div>
        
        <!-- Seletor de Cor Principal -->
        <div id="color-picker-container">
          <div id="main-color-display">
            <div id="current-color" style="background: #7c3aed;"></div>
            <div id="color-info">
              <span id="color-hex">#7C3AED</span>
              <span id="opacity-value">100%</span>
            </div>
          </div>
          
          <!-- Gradiente de Cor -->
          <div id="color-gradient">
            <canvas id="color-canvas" width="248" height="120"></canvas>
            <div id="color-picker-handle"></div>
          </div>
          
          <!-- Sliders -->
          <div id="color-sliders">
            <!-- Hue Slider -->
            <div class="slider-container">
              <div id="hue-slider" class="slider">
                <div id="hue-handle" class="slider-handle"></div>
              </div>
            </div>
            
            <!-- Opacity Slider -->
            <div class="slider-container">
              <div id="opacity-slider" class="slider">
                <div id="opacity-handle" class="slider-handle"></div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Paleta de Cores Rápidas -->
        <div id="quick-colors">
          <div id="colorPalette"></div>
        </div>
        
        <!-- Seção de IA removida -->
      </div>
    </div>

    <!-- Sidebar de Arquivos Carregados -->
    <div id="upload-history-sidebar" class="floating-panel">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14,2 14,8 20,8"/>
            <line x1="16" y1="13" x2="8" y2="13"/>
            <line x1="16" y1="17" x2="8" y2="17"/>
            <polyline points="10,9 9,9 8,9"/>
          </svg>
          Arquivos Carregados
        </h3>
        <button class="panel-close-btn" id="uploadHistorySidebarCloseBtn">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="panel-content">
        <div class="upload-section">
          <h4>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17,8 12,3 7,8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            Carregar Arquivo
          </h4>
          <div class="upload-input-container">
            <input type="file" id="voxelFileInput" accept=".html,.json" multiple style="display: none;">
            <label for="voxelFileInput" class="upload-input-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17,8 12,3 7,8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
              Escolher arquivo (.html, .json)
            </label>
          </div>
        </div>

        <div class="upload-section">
          <h4>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14,2 14,8 20,8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
            Histórico de Uploads
          </h4>
          <div id="uploadHistoryList" class="upload-history-list">
            <!-- Histórico de uploads do editor -->
            <div class="upload-history-empty">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" opacity="0.3">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
              </svg>
              <p>Nenhum arquivo carregado ainda</p>
              <small>Use o campo acima para carregar arquivos</small>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="help-button" data-tooltip="Ajuda e Atalhos">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
        <point cx="12" cy="17" r="1"/>
      </svg>
    </div>

    <!-- Painel de Ajuda -->
    <div id="help-panel">
      <div class="help-header">
        <h2>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386L9.663 17z"/>
          </svg>
          Guia de Controles
        </h2>
        <button class="help-close" id="help-close">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="help-content">
        <div class="help-section">
          <h3>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 11H1v8h8v-8zM23 11h-8v8h8v-8z"/>
              <path d="M9 11V1H1v10h8zM23 11V1h-8v10h8z"/>
            </svg>
            Seleção de Voxels
          </h3>
          <div class="help-item">
            <div class="shortcut">Shift (segurar) + Clique</div>
            <div class="description">Selecionar/desselecionar voxel - cursor "crosshair"</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Shift + Arrastar</div>
            <div class="description">Mover câmera pela grade (pan/deslocar visão)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Ctrl + Shift + Clique</div>
            <div class="description">Selecionar todos os voxels da mesma cor</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Shift + Alt + Clique</div>
            <div class="description">Selecionar todos os voxels conectados</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Ctrl + A</div>
            <div class="description">Selecionar todos os voxels da cena</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Escape</div>
            <div class="description">Limpar toda a seleção</div>
          </div>
        </div>

        <div class="help-section">
          <h3>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="3" y="3" width="18" height="18" rx="3"/>
              <path d="M9 9h6v6H9z"/>
            </svg>
            Criação de Áreas
          </h3>
          <div class="help-item">
            <div class="shortcut">Ctrl (segurar) + Clique + Arrastar</div>
            <div class="description">Criar área 3D preenchida - cursor muda para "copy"</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Setas ← → ↑ ↓ (com área ativa)</div>
            <div class="description">Expandir área horizontalmente</div>
          </div>
          <div class="help-item">
            <div class="shortcut">W / S (com área ativa)</div>
            <div class="description">Expandir área verticalmente (cima/baixo)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Arrastar handles visuais</div>
            <div class="description">Redimensionar área arrastando os cubos coloridos nas bordas e cantos</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Handles dos cantos (brancos)</div>
            <div class="description">Redimensionar área em múltiplas direções simultaneamente</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Handles das faces (coloridos)</div>
            <div class="description">Redimensionar área em uma direção específica (vermelho=X, verde=Y, azul=Z)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Page Up / Page Down (com área ativa)</div>
            <div class="description">Expandir área verticalmente (alternativo)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Escape (com área ativa)</div>
            <div class="description">Cancelar área ativa e voltar ao modo normal</div>
          </div>
        </div>

        <div class="help-section">
          <h3>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3"/>
              <path d="M2 12h20M12 2v20"/>
            </svg>
            Movimentação
          </h3>
          <div class="help-item">
            <div class="shortcut">Setas ← → ↑ ↓</div>
            <div class="description">Mover voxels selecionados horizontalmente</div>
          </div>
          <div class="help-item">
            <div class="shortcut">W / S</div>
            <div class="description">Subir/descer voxels selecionados (mais fácil que Page Up/Down)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Page Up / Page Down</div>
            <div class="description">Subir/descer voxels selecionados (alternativo)</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Delete / Backspace</div>
            <div class="description">Excluir voxels selecionados</div>
          </div>
        </div>

        <div class="help-section">
          <h3>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 20h9"/>
              <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/>
            </svg>
            Edição Geral
          </h3>
          <div class="help-item">
            <div class="shortcut">Clique</div>
            <div class="description">Adicionar voxel na posição</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Clique Duplo / Clique Direito</div>
            <div class="description">Remover voxel</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Ctrl + Z</div>
            <div class="description">Desfazer última ação</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Arrastar</div>
            <div class="description">Rotacionar câmera</div>
          </div>
          <div class="help-item">
            <div class="shortcut">Scroll</div>
            <div class="description">Zoom in/out</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Painéis Individuais do Room Mode -->
    
    <!-- Painel Upload/Controles -->
    <div id="room-upload-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="17,8 12,3 7,8"/>
            <line x1="12" y1="3" x2="12" y2="15"/>
          </svg>
          Upload & Controles
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-upload-panel')">×</button>
      </div>

      <div class="panel-content">
        <div class="upload-section">
          <h4>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
              <polyline points="17,8 12,3 7,8"/>
              <line x1="12" y1="3" x2="12" y2="15"/>
            </svg>
            Carregar Arquivo
          </h4>
          <div class="upload-input-container">
            <input type="file" id="voxel-file-input" accept=".html,.json" multiple style="display: none;">
            <label for="voxel-file-input" class="upload-input-label">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                <polyline points="17,8 12,3 7,8"/>
                <line x1="12" y1="3" x2="12" y2="15"/>
              </svg>
              Escolher arquivo (.html, .json)
            </label>
          </div>
        </div>

        <div class="upload-section">
          <h4>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
              <polyline points="7,10 12,15 17,10"></polyline>
              <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
            Objetos na Sala
          </h4>
          <div id="roomUploadHistoryList" class="upload-history-list">
            <!-- Objetos serão listados aqui dinamicamente -->
            <div class="upload-history-empty">
              <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1" opacity="0.3">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
              </svg>
              <p>Nenhum objeto carregado ainda</p>
              <small>Use o campo acima para carregar objetos</small>
            </div>
          </div>
        </div>

        <div class="upload-section">
          <h4>
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="3"/>
              <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1 1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
            </svg>
            Controles de Transformação
          </h4>
          <div id="transformControls" class="transform-controls-container">
            <!-- Controles serão adicionados dinamicamente aqui -->
          </div>
        </div>
      </div>
    </div>

    <!-- Painel Dimensões -->
    <div id="room-dimensions-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 14.76V3.5a2.5 2.5 0 0 0-5 0v11.26"/>
            <path d="M16 16v1.5a2.5 2.5 0 0 1-5 0V16"/>
            <path d="M8 8v8"/>
            <path d="M16 8v8"/>
          </svg>
          Dimensões da Sala
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-dimensions-panel')">×</button>
      </div>

      <div class="panel-content">
        <p class="panel-description">Configure as dimensões do ambiente 3D</p>
        
        <div class="dimension-controls">
          <div class="dimension-input">
            <label>Largura:</label>
            <input type="range" id="room-width" min="10" max="50" value="20" step="2">
            <span id="room-width-value">20m</span>
          </div>
          <div class="dimension-input">
            <label>Altura:</label>
            <input type="range" id="room-height" min="5" max="20" value="10" step="1">
            <span id="room-height-value">10m</span>
          </div>
          <div class="dimension-input">
            <label>Profundidade:</label>
            <input type="range" id="room-depth" min="10" max="50" value="20" step="2">
            <span id="room-depth-value">20m</span>
          </div>
        </div>
        
        <div class="dimension-actions">
          <button id="apply-dimensions" class="room-config-btn primary">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20,6 9,17 4,12"/>
            </svg>
            Aplicar Dimensões
          </button>
          <button id="reset-dimensions" class="room-config-btn secondary">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,4 23,10 17,10"/>
              <path d="M20.49,15a9,9,0,1,1-2.12-9.36L23,10"/>
            </svg>
            Resetar
          </button>
        </div>
      </div>
    </div>

    <!-- Painel Texturas Ambiente -->
    <div id="room-textures-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
            <polyline points="9,22 9,12 15,12 15,22"/>
          </svg>
          Texturas do Ambiente
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-textures-panel')">×</button>
      </div>

      <div class="panel-content">
        <p class="panel-description">Personalize as texturas das superfícies da sala</p>
        
        <div class="room-texture-selectors">
          <div class="room-texture-group">
            <label>Chão:</label>
            <select id="floor-texture">
              <option value="wood_oak">Madeira Carvalho</option>
              <option value="marble_white">Mármore Branco</option>
              <option value="brick_red">Tijolo Vermelho</option>
              <option value="metal_steel">Metal Aço</option>
              <option value="grass_green">Grama Verde</option>
            </select>
          </div>
          <div class="room-texture-group">
            <label>Paredes:</label>
            <select id="walls-texture">
              <option value="wallpaper_stripes" selected>Papel de Parede</option>
              <option value="brick_red">Tijolo Vermelho</option>
              <option value="wood_oak">Madeira Carvalho</option>
              <option value="marble_white">Mármore Branco</option>
              <option value="metal_steel">Metal Aço</option>
            </select>
          </div>
          <div class="room-texture-group">
            <label>Teto:</label>
            <select id="ceiling-texture">
              <option value="marble_white" selected>Mármore Branco</option>
              <option value="wood_oak">Madeira Carvalho</option>
              <option value="wallpaper_stripes">Papel de Parede</option>
              <option value="metal_steel">Metal Aço</option>
            </select>
          </div>
        </div>
        
        <div class="texture-actions">
          <button id="apply-room-config" class="room-config-btn primary">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="20,6 9,17 4,12"/>
            </svg>
            Aplicar Texturas
          </button>
          <button id="reset-room-config" class="room-config-btn secondary">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="23,4 23,10 17,10"/>
              <path d="M20.49,15a9,9,0,1,1-2.12-9.36L23,10"/>
            </svg>
            Resetar
          </button>
        </div>
      </div>
    </div>

    <!-- Painel Portas -->
    <div id="room-doors-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
            <circle cx="10" cy="12" r="1"/>
          </svg>
          Portas
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-doors-panel')">×</button>
      </div>

      <div class="panel-content">
        <p class="panel-description">Adicione portas funcionais que controlam a luz</p>
        
        <div class="door-window-creator">
          <div class="creator-row">
            <select id="door-wall-select">
              <option value="front">Parede Frontal</option>
              <option value="back">Parede Traseira</option>
              <option value="left">Parede Esquerda</option>
              <option value="right">Parede Direita</option>
            </select>
            <input type="text" id="door-id" placeholder="ID da porta" value="porta1">
          </div>
          <div class="creator-row">
            <label>Posição X:</label>
            <input type="range" id="door-pos-x" min="-5" max="5" value="0" step="0.1">
            <span id="door-pos-x-value">0.0m</span>
          </div>
          <button id="create-door-btn" class="door-window-btn primary">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Criar Porta
          </button>
        </div>
        
        <!-- Lista de Portas -->
        <div class="door-window-list" id="doors-list">
          <!-- Portas serão listadas aqui -->
        </div>
      </div>
    </div>

    <!-- Painel Janelas -->
    <div id="room-windows-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <path d="M9 3v18"/>
            <path d="M15 3v18"/>
            <path d="M3 9h18"/>
            <path d="M3 15h18"/>
          </svg>
          Janelas
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-windows-panel')">×</button>
      </div>

      <div class="panel-content">
        <p class="panel-description">Adicione janelas funcionais que controlam a luz</p>
        
        <div class="door-window-creator">
          <div class="creator-row">
            <select id="window-wall-select">
              <option value="front">Parede Frontal</option>
              <option value="back">Parede Traseira</option>
              <option value="left">Parede Esquerda</option>
              <option value="right">Parede Direita</option>
            </select>
            <input type="text" id="window-id" placeholder="ID da janela" value="janela1">
          </div>
          <div class="creator-row">
            <label>Posição X:</label>
            <input type="range" id="window-pos-x" min="-5" max="5" value="0" step="0.1">
            <span id="window-pos-x-value">0.0m</span>
          </div>
          <div class="creator-row">
            <label>Altura Y:</label>
            <input type="range" id="window-pos-y" min="1.0" max="3" value="1.5" step="0.1">
            <span id="window-pos-y-value">1.5m</span>
          </div>
          <div class="creator-row">
            <label>
              <input type="checkbox" id="window-can-open" checked>
              <span>Pode abrir</span>
            </label>
          </div>
          <button id="create-window-btn" class="door-window-btn primary">
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="12" y1="5" x2="12" y2="19"/>
              <line x1="5" y1="12" x2="19" y2="12"/>
            </svg>
            Criar Janela
          </button>
        </div>
        
        <!-- Lista de Janelas -->
        <div class="door-window-list" id="windows-list">
          <!-- Janelas serão listadas aqui -->
        </div>
      </div>
    </div>

    <!-- Painel Texturas para Voxels -->
    <div id="room-voxel-textures-panel" class="room-individual-panel" style="display: none;">
      <div class="panel-header">
        <h3>
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
            <circle cx="9" cy="9" r="2"/>
            <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
          </svg>
          Texturas para Voxels
        </h3>
        <button class="panel-close-btn" onclick="closeRoomPanel('room-voxel-textures-panel')">×</button>
      </div>

      <div class="panel-content">
        <p class="panel-description">Selecione texturas para aplicar aos voxels criados</p>
        
        <div class="texture-selector">
          <div class="texture-grid" id="texture-grid">
            <!-- Texturas serão carregadas dinamicamente -->
          </div>
          
          <div class="texture-controls">
            <div class="texture-mode-selector">
              <label>
                <input type="radio" name="textureMode" value="single" checked>
                <span>Textura única</span>
              </label>
              <label>
                <input type="radio" name="textureMode" value="per-face">
                <span>Por face</span>
              </label>
            </div>
            
            <div class="current-texture-display">
              <span>Textura atual: </span>
              <span id="current-texture-name">Nenhuma</span>
            </div>
          </div>
        </div>
        
        <div class="texture-actions">
          <button id="roomSaveBtn" class="room-btn">Salvar Configuração</button>
          <button id="roomClearBtn" class="room-btn danger">Limpar Texturas</button>
        </div>
      </div>
    </div>

    <!-- Barra Vertical de Ícones -->
    <div id="icon-toolbar">
      <!-- Logo da Aplicação -->
      <div class="logo-container">
        <img src="logo.png" alt="Vertex Logo" class="app-logo">
      </div>
      
      <div class="icon-btn" id="menuBtn" data-tooltip="Color Palette">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10c1.19 0 2-.81 2-2 0-.53-.2-1-.53-1.36-.32-.35-.47-.84-.47-1.36 0-1.1.9-2 2-2h2.5c3.04 0 5.5-2.46 5.5-5.5C22 6.48 17.52 2 12 2z"/>
          <circle cx="6.5" cy="11.5" r="1.5" fill="currentColor"/>
          <circle cx="9.5" cy="7.5" r="1.5" fill="currentColor"/>
          <circle cx="14.5" cy="7.5" r="1.5" fill="currentColor"/>
          <circle cx="17.5" cy="11.5" r="1.5" fill="currentColor"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="testBtn" data-tooltip="Add Cube">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 8v8M8 12h8"/>
          <rect x="3" y="3" width="18" height="18" rx="3"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="undoBtn" data-tooltip="Undo">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M9 14 4 9l5-5"/>
          <path d="M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5v0a5.5 5.5 0 0 1-5.5 5.5H11"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="clearBtn" data-tooltip="Clear All">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 6h18"/>
          <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
          <path d="M8 6V4c0-1 1-2 2-2h4c0-1 1-2 2-2v2"/>
          <line x1="10" y1="11" x2="10" y2="17"/>
          <line x1="14" y1="11" x2="14" y2="17"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="uploadBtn" data-tooltip="Reference Image">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
          <circle cx="9" cy="9" r="2"/>
          <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
        </svg>
      </div>
      
      <!-- Botão AI removido -->
      
      <div class="icon-btn" id="exportBtn" data-tooltip="Export">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
          <polyline points="7,10 12,15 17,10"/>
          <line x1="12" y1="15" x2="12" y2="3"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="uploadHistoryBtn" data-tooltip="Histórico de Uploads">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M16 16l-4-4-4 4"/>
          <path d="M12 12v9"/>
          <path d="M20.39 18.39A5 5 0 0 0 18 9h-1.26A8 8 0 1 0 3 16.3"/>
          <polyline points="16,16 12,12 8,16"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="roomModeBtn" data-tooltip="Modo Sala Ambiente">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
          <polyline points="9,22 9,12 15,12 15,22"/>
        </svg>
      </div>
      
      <div class="icon-btn" id="tutorialBtn" data-tooltip="Tutoriais">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 10v6M2 10l10-5 10 5-10 5z"/>
          <path d="M6 12v5c3 3 9 3 12 0v-5"/>
        </svg>
      </div>
      
      <!-- Contador de Voxels na parte inferior -->
      <div id="voxel-counter-icon" data-tooltip="Voxel Count">
        <div id="voxelCount">0</div>
      </div>
    </div>
    
    <div id="three-container">
      <canvas id="three-canvas"></canvas>
      
      <!-- Dica para trackpad -->
      <div id="trackpad-hint" class="trackpad-hint">
        💡 Trackpad: Clique para adicionar • Arraste para rotacionar • Scroll para zoom • Clique direito para remover
      </div>
      
      <!-- Imagem de Referência Flutuante -->
      <div id="floating-reference" style="display: none;">
        <div id="floating-reference-header">
          <span id="floating-reference-title">Reference Image</span>
          <div id="floating-reference-controls">
            <button id="floating-opacity-btn" title="Change Opacity">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                <circle cx="12" cy="12" r="3"></circle>
              </svg>
            </button>
            <button id="floating-remove-btn" title="Remove Image">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
              </svg>
            </button>
          </div>
        </div>
        <div id="floating-reference-content">
          <img id="floating-reference-image" alt="Floating reference image" />
          <div id="resize-handle"></div>
        </div>
      </div>
    </div>
  </div>
  <script type="importmap">
    {
      "imports": {
        "three": "https://unpkg.com/three@0.155.0/build/three.module.js",
        "three/addons/": "https://unpkg.com/three@0.155.0/examples/jsm/"
      }
    }
  </script>
  <script type="module">
    import * as THREE from 'three';
    import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
    
    // Tornar disponível globalmente para compatibilidade
    window.THREE = THREE;
    window.OrbitControls = OrbitControls;
    
    console.log('Three.js carregado:', typeof THREE !== 'undefined');
    console.log('OrbitControls disponível:', typeof OrbitControls !== 'undefined');
    
    // Carregar módulos e script principal
    Promise.all([
      import('./modules/colorSystem.js'),
      import('./modules/fileUploadSystem.js'),
      import('./modules/referenceSystem.js'),
      import('./modules/mouseSystem.js'),
      import('./modules/roomMode.js'),
      import('./modules/walkBuildMode.js'),
      import('./modules/timeSystem.js'),
      import('./modules/tutorialSystem.js'),
      import('./modules/textureSystem.js'),
      import('./modules/roomConfigSystem.js'),
      import('./modules/doorWindowSystem.js'),
      import('./modules/exportSystem.js'),
      import('./modules/voxelSelectionSystem.js'),
      import('./modules/areaFillSystem.js'),
      import('./modules/uploadHistorySystem.js'),
      import('./modules/helpSystem.js'),
      import('./modules/editorLightingSystem.js'),
      import('./modules/hybridInteractionSystem.js'),
      import('./modules/atmosphereRenderingSystem.js'),
      import('./tutorials/dragObjectsTutorial.js')
    ]).then(([colorModule, fileUploadModule, referenceModule, mouseModule, roomModule, walkBuildModule, timeModule, tutorialModule, textureModule, roomConfigModule, doorWindowModule, exportModule, voxelSelectionModule, areaFillModule, uploadHistoryModule, helpSystemModule, editorLightingModule, hybridInteractionModule, atmosphereRenderingModule, dragTutorialModule]) => {
      window.ColorSystem = colorModule.ColorSystem;
      window.FileUploadSystem = fileUploadModule.FileUploadSystem;
      window.ReferenceImageSystem = referenceModule.ReferenceImageSystem;
      window.MouseInteractionSystem = mouseModule.MouseInteractionSystem;
      window.RoomModeSystem = roomModule.RoomModeSystem;
      window.WalkBuildModeSystem = walkBuildModule.WalkBuildModeSystem;
      window.TimeSystem = timeModule.TimeSystem;
      window.TutorialSystem = tutorialModule.TutorialSystem;
      window.TextureSystem = textureModule.TextureSystem;
      window.RoomConfigSystem = roomConfigModule.RoomConfigSystem;
      window.DoorWindowSystem = doorWindowModule.DoorWindowSystem;
      window.ExportSystem = exportModule.ExportSystem;
      window.VoxelSelectionSystem = voxelSelectionModule.VoxelSelectionSystem;
      window.AreaFillSystem = areaFillModule.AreaFillSystem;
      window.UploadHistorySystem = uploadHistoryModule.UploadHistorySystem;
      window.HelpSystem = helpSystemModule.HelpSystem;
      window.EditorLightingSystem = editorLightingModule.EditorLightingSystem;
      window.HybridInteractionSystem = hybridInteractionModule.HybridInteractionSystem;
      window.AtmosphereRenderingSystem = atmosphereRenderingModule.AtmosphereRenderingSystem;
      window.dragObjectsTutorial = dragTutorialModule.dragObjectsTutorial;
      
      // Carregar o script principal após módulos estarem prontos
      const script = document.createElement('script');
      script.src = 'editor.js';
      document.body.appendChild(script);
    });
  </script>

  <!-- Inventário Estilo Minecraft (visível apenas no walk mode) -->
  <div id="minecraft-inventory" class="minecraft-inventory" style="display: none;">
    <div class="hotbar">
      <div class="hotbar-slot" data-slot="0">
        <div class="item-icon window-icon">🪟</div>
        <div class="item-name">Janela</div>
      </div>
      <div class="hotbar-slot" data-slot="1">
        <div class="item-icon door-icon">🚪</div>
        <div class="item-name">Porta</div>
      </div>
      <div class="hotbar-slot" data-slot="2">
        <div class="item-icon lamp-warm-icon">��💡</div>
        <div class="item-name">Lâmpada Quente</div>
        <div class="item-temp">2800K</div>
      </div>
      <div class="hotbar-slot" data-slot="3">
        <div class="item-icon lamp-cool-icon">❄️💡</div>
        <div class="item-name">Lâmpada Fria</div>
        <div class="item-temp">6000K</div>
      </div>
      <div class="hotbar-slot" data-slot="4"></div>
      <div class="hotbar-slot" data-slot="5"></div>
      <div class="hotbar-slot" data-slot="6"></div>
      <div class="hotbar-slot" data-slot="7"></div>
      <div class="hotbar-slot" data-slot="8"></div>
    </div>
    <div class="selected-item-info">
      <div id="selected-item-name">Nenhum item selecionado</div>
      <div id="selected-item-description">Selecione um item no inventário</div>
    </div>
  </div>

  <!-- Crosshair para modo construção -->
  <div id="construction-crosshair" class="crosshair" style="display: none;">
    <div class="crosshair-dot"></div>
    <div class="crosshair-lines">
      <div class="crosshair-line horizontal"></div>
      <div class="crosshair-line vertical"></div>
    </div>
  </div>

</body>
</html>
